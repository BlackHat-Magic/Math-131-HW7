\documentclass[12pt,twoside]{amsart}

% formatting stuff
\addtolength{\hoffset}{-2.75cm}
\addtolength{\textwidth}{5.5cm}
\addtolength{\voffset}{-2.5cm}
\addtolength{\textheight}{3.5cm}
\setlength{\headheight}{17pt}

% \usepackage{amsthm}
% \usepackage{amsmath}
\usepackage{amssymb}
\usepackage[colorlinks = true, linkcolor = black, citecolor = black, final]{hyperref}
\usepackage{enumerate}

\usepackage{graphicx}
% \usepackage{multicol}

\usepackage{paracol}
\setlength{\parskip}{0pt}
\setlength{\parindent}{0pt}

\usepackage{paracol}
\setlength{\parskip}{0pt}
\setlength{\parindent}{0pt}

% \usepackage{ marvosym }
% \usepackage{wasysym}
% \usepackage{tikz}
% \usetikzlibrary{patterns}

\usepackage{fancyhdr}

\usepackage{listings}
\usepackage{xcolor}
\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}

\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},   
    commentstyle=\color{codegreen},
    keywordstyle=\color{magenta},
    % numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=none,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=2
}
\lstset{style=mystyle}

\newcommand{\ds}{\displaystyle}

\setlength{\parindent}{0in}

\pagestyle{empty}

% ----------------------------
% end preamble
% -----------------------------

\begin{document}

\thispagestyle{fancy}
\pagestyle{fancy}
\fancyhf{}
\fancyhead[LE,LO]{\scshape Math 131}
\fancyhead[CE,CO]{\scshape \large Assignment 7}
\fancyhead[RE,RO]{\scshape Luke Henderson}

For the source code for the coding problems, see the attached Jupyter notebook, Matlab live script. Alternatively, the entire git repository  is attached as a zip archive, and is available \href{https://github.com/blackHat-Magic/math-131-HW7}{on GitHub}. The comments in the code have been omitted here for brevity. They are present in the Jupyter notebook and Matlab live script.

\begin{enumerate}
    \item \textbf{Problem Statement:} Perform Gaussian Elimination in order to solve the system $Ax = b$.
    \begin{align*}
        \left[\begin{array}{ccc}
            2 & 1 & -1 \\
            -3 & -1 & 2 \\
            -2 & 1 & 2 \\
        \end{array}\right]\left[\begin{array}{c}
            x_1 \\
            x_2 \\
            x_3 \\
        \end{array}\right] & = \left[\begin{array}{c}
            8 \\
            -11 \\
            -3 \\
        \end{array}\right] \\
        \left[\begin{array}{ccc|c}
            2 & 1 & -1 & 8 \\
            -3 & -1 & 2 & -11 \\
            -2 & 1 & 2 & -3 \\
        \end{array}\right] & \begin{array}{c}
            \text{R2} = \text{R2} + \frac{3}{2}\text{R1} \\
            \text{R3} = \text{R3} + \text{R1} \\
        \end{array} \\
        \left[\begin{array}{ccc|c}
            2 & 1 & -1 & 8 \\
            0 & \frac{1}{2} & \frac{1}{2} & 1 \\
            0 & 2 & 1 & 5 \\
        \end{array}\right] & \text{R3} = \text{R3} - 4\text{R2} \\
        \left[\begin{array}{ccc|c}
            2 & 1 & -1 & 8 \\
            0 & \frac{1}{2} & \frac{1}{2} & 1 \\
            0 & 0 & -1 & 1 \\
        \end{array}\right]
    \end{align*}
    \begin{align*}
        -1x_3 & = 1 \\
        x_3 = -1 \\
    \end{align*}
    \begin{align*}
        \frac{1}{2}x_2 + \frac{1}{2}x_3 & = 1 \\
        \frac{1}{2}x_2 - \frac{1}{2} & = 1 \\
        \frac{1}{2}x_2 & = \frac{3}{2} \\
        x_2 & = 3 \\
    \end{align*}
    \begin{align*}
        2x_1 + x_2 - x_3 & = 8 \\
        2x_1 + 3 + 1 = 8 \\
        2x_1 = 4 \\
        x_1 = 2 \\
    \end{align*}
    \bigskip

    \item \textbf{Problem Statement:} Consider the following linear system. Perform row and column swapping to create a system which is diagonally dominant.
    \begin{align*}
    \left[\begin{array}{ccccc}
        1 & 2 & 0 & 0 & 0 \\
        -7 & -3 & 0 & 0 & 0 \\
        0 & 0 & 2 & 0 & -4 \\
        0 & 0 & 10 & 2 & -2 \\
        0 & 0 & 0 & 1 & 0 \\
    \end{array}\right]\left[\begin{array}{c}
        x_1 \\
        x_2 \\
        x_3 \\
        x_4 \\
        x_5 \\
    \end{array}\right] & = \left[\begin{array}{c}
        -8 \\
        -7 \\
        3 \\
        3 \\
        -5 \\
    \end{array}\right] \\
    \left[\begin{array}{ccccc|c}
        1 & 2 & 0 & 0 & 0 & -8 \\
        -7 & -3 & 0 & 0 & 0 & -7 \\
        0 & 0 & 2 & 0 & -4 & 3 \\
        0 & 0 & 10 & 2 & -2 & 3 \\
        0 & 0 & 0 & 1 & 0 & -5 \\
    \end{array}\right] & \begin{array}{c}
        \text{swap(R1, R2)} \\
        \text{swap(R3, R4)} \\
    \end{array} \\
    \left[\begin{array}{ccccc|c}
        -7 & -3 & 0 & 0 & 0 & -7 \\
        1 & 2 & 0 & 0 & 0 & -8 \\
        0 & 0 & 10 & 2 & -2 & 3 \\
        0 & 0 & 2 & 0 & -4 & 3 \\
        0 & 0 & 0 & 1 & 0 & -5 \\
    \end{array}\right] & \begin{array}{c}
        \text{swap(C4, C5)}
    \end{array} \\
    \left[\begin{array}{ccccc|c}
        -7 & -3 & 0 & 0 & 0 & -7 \\
        1 & 2 & 0 & 0 & 0 & -8 \\
        0 & 0 & 10 & -2 & 2 & 3 \\
        0 & 0 & 2 & -4 & 0 & 3 \\
        0 & 0 & 0 & 0 & 1 & -5 \\
    \end{array}\right] \\
    \end{align*}
    \bigskip

    \item \textbf{Problem Statement:} Determine $L$ and $U$ such that $A = LU$.
    $$
    A = \left[\begin{array}{ccc}
        5 & 4 & 2 \\
        4 & 2 & 4 \\
        2 & 1 & 4 \\
    \end{array}\right] = \left[\begin{array}{ccc}
        \ell_{11} & 0 & 0 \\
        \ell_{21} & \ell_{22} & 0 \\
        \ell_{31} & \ell_{32} & \ell_{33} \\
    \end{array}\right]\left[\begin{array}{ccc}
        1 & u_{12} & u_{13} \\
        0 & 1 & u_{23} \\
        0 & 0 & 1 \\
    \end{array}\right]
    $$
    \begin{paracol}{2}
        $$
        \ell_{11} = 5
        $$
        $$
        \ell_{21} = 4
        $$
        $$
        \ell_{31} = 2
        $$
        \begin{align*}
            \ell_{11}u_{12} & = 4 \\
            5u_{12}&  = 4 \\
            u_{12} & = 0.8 \\
        \end{align*}
        \begin{align*}
            \ell_{21}u_{12} + \ell_{22} & = 2 \\
            4(0.8) + \ell_{22} & = 2 \\
            \ell_{22} & = -1.2 \\
        \end{align*}
        \begin{align*}
            \ell_{31}u_{12} + \ell_{32} & = 1 \\
            2(0.8) + \ell_{32} & = 1 \\
            \ell_{32} & = -0.6 \\
        \end{align*}
    \switchcolumn
        \begin{align*}
            \ell_{11}u_{13} & = 2 \\
            5u_{13} & = 2 \\
            u_{13} & = 0.4 \\
        \end{align*}
        \begin{align*}
            \ell_{21}u_{13} + \ell_{22}u_{23} = 4 \\
            4(0.4) - 1.2u_{23} = 4 \\
            -1.2u_{23} = 2.4 \\
            u_{23} = -2
        \end{align*}
        \begin{align*}
            \ell_{31}u_{13} + \ell_{32}u_{23} + \ell_{33} & = 4 \\
            2(0.4) - 0.6(-2) + \ell_{33} & = 4 \\
            0.8 + 1.2 + \ell_{33} & = 4 \\
            \ell_{33} & = 2 \\
        \end{align*}
    \end{paracol}
    \begin{paracol}{2}
        $$L = \left[\begin{array}{ccc}
            5 & 0 & 0 \\
            4 & -1.2 & 0 \\
            2 & -0.6 & 2 \\
        \end{array}\right]$$
    \switchcolumn
        $$U = \left[\begin{array}{ccc}
            1 & 0.8 & 0.4 \\
            0 & 1 & -2 \\
            0 & 0 & 1 \\
        \end{array}\right]$$
    \end{paracol}
    \bigskip

    \item \textbf{Problem Statement:} Write a function called \texttt{jacobi} that has as inputs an $n\times n$ matrix, $A$, a column vector, $b$, an initial guess $x^(0)$, an error tolerance $\epsilon$, and a maximum number of iterations, and as outputs an approximate solution obtained using the Jacobi method, the residual error and the number of iterations. Use the method to find approximate solutions to the linear system from problem 2 after you have made it diagonally dominant. If you chose not to complete problem 2, you may use the $5\times5$ matrix of your choice. Find the solution within an accuracy of $\epsilon = 10^{-5}$, with a maximum of $N = 100$ iterations. If your method succeeds, report the number of iterations needed. If your method fails, offer a possible reason why. \\
    \lstinputlisting[language=Python, caption=Python]{../py/problem4.py}
    It took 17 iterations. \\
    \bigskip

    \item\textbf{Problem Statement:} Write a function called \texttt{gauss\_seidel} that has as inputs an $n \times n$ matrix, $A$, a column vector, $b$, an initial guess $x^{(0)}$, an error tolerance $\epsilon$, and a maximum number of iterations, and as outputs an approximate solution obtained using the Gauss-Seidel method, the residual error and the number of iterations. Use the method to find approximate solutions to the linear system from the previous problem to within an accuracy of $\epsilon = 10^{-5}$, with a maximum of $N = 100$ iterations. If your method succeeds, report the number of iterations needed. If your method fails, offer a possible reason why. \\
    \lstinputlisting[language=Python, caption=Python]{../py/problem5.py}
    It took 10 iterations. \\
    \bigskip
\end{enumerate}

\end{document}